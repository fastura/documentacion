"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[40915],{939896:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Devs/Devops/manual-de-actualizacion","title":"Manual de Actualizacion","description":"Requisitos previos","source":"@site/versioned_docs/version-Pro7/Devs/Devops/manual-de-actualizacion.md","sourceDirName":"Devs/Devops","slug":"/Devs/Devops/manual-de-actualizacion","permalink":"/Pro7/Devs/Devops/manual-de-actualizacion","draft":false,"unlisted":false,"tags":[],"version":"Pro7","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Conexi\xf3n servidor - Winscp","permalink":"/Pro7/Devs/Devops/Manuales-de-actualizacion/Conexion-Winscp"},"next":{"title":"Migraci\xf3n de Documento Individual","permalink":"/Pro7/Devs/Devops/migracion-de-documento-individual"}}');var r=n(474848),o=n(28453);const i={},c="Manual de Actualizacion",l={},d=[{value:"Requisitos previos",id:"requisitos-previos",level:3},{value:"Pasos",id:"pasos",level:3},{value:"Caso FPM",id:"caso-fpm",level:3},{value:"Maria DB",id:"maria-db",level:3},{value:"Comandos extras",id:"comandos-extras",level:3},{value:"Posibles errores",id:"posibles-errores",level:3}];function t(e){const a={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"manual-de-actualizacion",children:"Manual de Actualizacion"})}),"\n",(0,r.jsx)(a.h3,{id:"requisitos-previos",children:"Requisitos previos"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsx)(a.li,{children:"Tener acceso a su servidor, vps, m\xe1quina virtual o local via SSH, en las instalaciones que realizamos para AWS o Google Cloud, hacemos entrega del usuario, la IP del servidor y la clave ssh que puede ser un archivo .ppk o .pem."}),"\n",(0,r.jsx)(a.li,{children:"Tener instalado una versi\xf3n de ssh en su m\xe1quina para conectarse de manera remota, puede utilizar putty, filezilla o una consola terminal."}),"\n",(0,r.jsx)(a.li,{children:"Tener los accesos y credenciales de GitLab y de los entornos creados con Docker, usuario mysql, root entre otros que tambi\xe9n son entregados una vez realizada la instalaci\xf3n, aunque una vez dentro de la instancia puede encontrarlos en los archivos .env y docker-compose.yml."}),"\n",(0,r.jsx)(a.li,{children:"Conocer el nombre del proyecto, en el ejemplo se ha usado multifacturalo, debe tomar en cuenta el proyecto que se le ha compartido en Gitlab"}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"pasos",children:"Pasos"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsx)(a.p,{children:"Acceder a su instancia v\xeda SSH (esta parte ya la deben conocer)."}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:["Loguearse como super usuario\r\nejecute ",(0,r.jsx)(a.strong,{children:"sudo su"})]}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:["Ejecutar ",(0,r.jsx)(a.strong,{children:"docker ps"})," y verificar que est\xe9n al menos las siguientes l\xedneas que equivalen a los contenedores de cada servicio iniciado por docker."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(a.p,{children:["En la lista deber\xe1 fijarse en los ",(0,r.jsx)(a.strong,{children:"NAMES"})," que contengan ",(0,r.jsx)(a.strong,{children:"fpm"})," y ",(0,r.jsx)(a.strong,{children:"mariadb"})," ya que en ellos deber\xe1 acceder."]}),"\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.strong,{children:"a.  multifacturalo_fpm2_1"})," equivale al nombre del proyecto donde una vez accedido se encontrar\xe1 justo en la ruta donde se ha alojado el repositorio y podr\xe1 ejecutar comandos ",(0,r.jsx)(a.strong,{children:"artisan"}),", ",(0,r.jsx)(a.strong,{children:"git"})," o ",(0,r.jsx)(a.strong,{children:"composer"}),". Este nombre puede variar un poco, puede llamarse ",(0,r.jsx)(a.strong,{children:"multifacturalo_fpm1_1."}),"\r\n",(0,r.jsx)(a.strong,{children:"b. multifacturalo_mariadb2_1"})," es el contenedor donde podr\xe1 acceder a mysql y utilizar comandos para ello, (desde aqu\xed no se ejecutan comandos php, artisan, git, entre otros)."]}),"\n",(0,r.jsxs)(a.ol,{start:"4",children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsx)(a.p,{children:"Una vez ubicado el contenedor a acceder ejecute el siguiente comando:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"docker exec -ti multifacturalo_fpm1_1 bash\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"De esta manera se conectar\xe1 al contenedor, observar\xe1 una cambio en el inicio de la terminal."}),"\n",(0,r.jsx)(a.h3,{id:"caso-fpm",children:"Caso FPM"}),"\n",(0,r.jsxs)(a.p,{children:["Si ha accedido a ",(0,r.jsx)(a.strong,{children:"fpm"})," entonces se debe encontrar en la ruta /var/www/html/ donde podr\xe1 ejecutar comandos de la siguiente lista (cada comando se ejecuta para situaciones distintas, mayormente no se necesitan ejecutar m\xe1s de dos comandos en una actualizaci\xf3n)"]}),"\n",(0,r.jsx)(a.h1,{id:"git-pull-origin-master-usar-siempre",children:"git pull origin master (usar siempre)"}),"\n",(0,r.jsx)(a.h1,{id:"git-log--5",children:"git log -5"}),"\n",(0,r.jsx)(a.h1,{id:"php-artisan-migrate-usar-siempre",children:"php artisan migrate (usar siempre)"}),"\n",(0,r.jsxs)(a.h1,{id:"php-artisan-tenancy-usar-siempre",children:["php artisan tenancy",":migrate"," (usar siempre)"]}),"\n",(0,r.jsxs)(a.h1,{id:"php-artisan-storage",children:["php artisan storage",":link"]}),"\n",(0,r.jsxs)(a.h1,{id:"php-artisan-config-usar-siempre",children:["php artisan config",":cache"," (usar siempre)"]}),"\n",(0,r.jsxs)(a.h1,{id:"php-artisan-config",children:["php artisan config",":clear"]}),"\n",(0,r.jsxs)(a.h1,{id:"php-artisan-cache-usar-siempre",children:["php artisan cache",":clear"," (usar siempre)"]}),"\n",(0,r.jsx)(a.h1,{id:"composer-update",children:"composer update"}),"\n",(0,r.jsx)(a.h1,{id:"composer-install",children:"composer install"}),"\n",(0,r.jsx)(a.h1,{id:"composer-dumpautoload",children:"composer dumpautoload"}),"\n",(0,r.jsxs)(a.p,{children:["Si ha utilizado ",(0,r.jsx)(a.strong,{children:"git pull origin master"})," debe ingresar las credenciales de GitLab, su correo y contrase\xf1a de acceso (la contrase\xf1a no se muestra en pantalla al ingresarla)"]}),"\n",(0,r.jsxs)(a.p,{children:["Debe hacer uso de los comandos seg\xfan sea el caso, por ejemplo, posterior a un git pull origin master que le muestre cambios en migraciones, deber\xe1 ejecutar ",(0,r.jsx)(a.strong,{children:"#php artisan migrate"})," y ",(0,r.jsxs)(a.strong,{children:["#php artisan tenancy",":migrate",","]})," de esta manera actualizar\xe1 los campos de las bases de datos, b\xe1sicamente cada comando cumple una funci\xf3n espec\xedfica y no todos son usados cada vez que se realiza una actualizaci\xf3n."]}),"\n",(0,r.jsx)(a.h3,{id:"maria-db",children:"Maria DB"}),"\n",(0,r.jsx)(a.p,{children:"Si ha accedido a mariadb podr\xe1 hacer uso de comandos mysql \xfanicamente, al acceder deber\xe1 utilizar"}),"\n",(0,r.jsx)(a.h1,{id:"mysql--u-root--p",children:"mysql -u root -p"}),"\n",(0,r.jsxs)(a.p,{children:["le solicitar\xe1 la contrase\xf1a la cual se encuentra en el archivo .env dentro del proyecto, tambi\xe9n le fue entregada al momento de instalar el proyecto en su servidor, si ha utilizado los canales de ",(0,r.jsx)(a.strong,{children:"Slack,"})," estos est\xe1n mayormente en las chinchetas del canal."]}),"\n",(0,r.jsx)(a.h3,{id:"comandos-extras",children:"Comandos extras"}),"\n",(0,r.jsx)(a.p,{children:"Para detener y restaurar los contenedores (servicios) dir\xedjase a la ruta de su proyecto y ejecute los siguientes comandos"}),"\n",(0,r.jsx)(a.h1,{id:"docker-compose-down",children:"docker-compose down"}),"\n",(0,r.jsx)(a.h1,{id:"docker-compose-up--d",children:"docker-compose up -d"}),"\n",(0,r.jsx)(a.p,{children:"Otra manera de detener los contenedores puede ser individualmente con los siguientes comandos"}),"\n",(0,r.jsx)(a.h1,{id:"docker-stop-multifacturalo_fpm2_1",children:"docker stop multifacturalo_fpm2_1"}),"\n",(0,r.jsx)(a.h1,{id:"docker-start-multifacturalo_fpm2_1",children:"docker start multifacturalo_fpm2_1"}),"\n",(0,r.jsx)(a.h1,{id:"docker-restart-multifacturalo_fpm2_1",children:"docker restart multifacturalo_fpm2_1"}),"\n",(0,r.jsx)(a.p,{children:"Si desea respaldar o montar un respaldo de una bd puede ejecutar los siguientes comandos"}),"\n",(0,r.jsx)(a.h1,{id:"backup",children:"Backup"}),"\n",(0,r.jsx)(a.p,{children:"docker exec CONTAINER /usr/bin/mysqldump -u root --password=root DATABASE > backup.sql"}),"\n",(0,r.jsx)(a.h1,{id:"restore",children:"Restore"}),"\n",(0,r.jsx)(a.p,{children:"cat backup.sql | docker exec -i CONTAINER /usr/bin/mysql -u root --password=root DATABASE"}),"\n",(0,r.jsx)(a.p,{children:"Donde CONTAINER se refiere al nombre del contenedor multifacturalo_fpm2_1"}),"\n",(0,r.jsx)(a.h3,{id:"posibles-errores",children:"Posibles errores"}),"\n",(0,r.jsx)(a.p,{children:"Luego de una actualizaci\xf3n donde utilice el comando \u201ccomposer install\u201d debe darle permisos a la carpeta en vendor del paquete de mpdf"}),"\n",(0,r.jsx)(a.h1,{id:"chmod--r-777-vendormpdfmpdftmp",children:"chmod -R 777 vendor/mpdf/mpdf/tmp"})]})}function u(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},28453:(e,a,n)=>{n.d(a,{R:()=>i,x:()=>c});var s=n(296540);const r={},o=s.createContext(r);function i(e){const a=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:a},e.children)}}}]);